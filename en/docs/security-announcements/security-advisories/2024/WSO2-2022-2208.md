---
title: Security Advisory WSO2-2022-2208
category: security-announcements
published: May 31, 2024
version: 1.0.0
severity: High
cvss: "8.9 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:L)"
---

# SECURITY ADVISORY WSO2-2022-2208

<p class="doc-info">Published: May 31, 2024</p>
<p class="doc-info">Version: 1.0.0</p>
<p class="doc-info">Severity: High</p>
<p class="doc-info">CVSS Score: 8.9 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:L)</p>
---

### AFFECTED PRODUCTS
* WSO2 API Manager : 4.1.0, 4.0.0, 3.2.0, 3.1.0


### OVERVIEW
JWT signature validation ignored when JWKS endpoint is unavailable.


### DESCRIPTION
When **validating JWTs generated by external OAuth providers** [^1], if JWKS endpoint call fails due to a network issue, or returns an unexpected response, the JWT token is considered to be valid.



### IMPACT
This vulnerability only affected deployments that use JWTs generated by external OAuth providers to authenticate APIs. Since the JWT token is considered to be valid when the specific condition highlighted in the [Description](#description) is met, the backend call is made without doing the signature validation.


### SOLUTION
If the latest version of the affected WSO2 product is not mentioned under the affected product list, you may migrate to the latest version to receive security fixes. Otherwise you may apply the relevant fixes to the product based on the public fix: 

* [https://github.com/wso2/carbon-apimgt/pull/11653](https://github.com/wso2/carbon-apimgt/pull/11653)


!!! info todo
    **If you are a WSO2 customer with Support Subscription, please use [WSO2 Updates](https://wso2.com/updates/) in order to apply the fix.**

### References
[^1]: [https://apim.docs.wso2.com/en/latest/design/api-security/oauth2/access-token-types/jwt-tokens/#validating-jwts-generated-by-external-oauth-providers](https://apim.docs.wso2.com/en/latest/design/api-security/oauth2/access-token-types/jwt-tokens/#validating-jwts-generated-by-external-oauth-providers)

